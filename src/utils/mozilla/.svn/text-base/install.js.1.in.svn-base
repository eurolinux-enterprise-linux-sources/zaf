// Spell checking dictionary for Mozilla Thunderbird
// Script written by rockstiff. Dictionary from openoffice.org

const APP_DISPLAY_NAME	= "{LANGNAME} ({REGIONNAME}) dictionary";
const APP_NAME			= "spell-{LANG}-{REGION}";
const APP_PACKAGE		= "dictionaries.mozdev.org/spell-{LANG}-{REGION}";
const APP_VERSION		= "{VERSION}";

var err = initInstall(APP_NAME, APP_PACKAGE, APP_VERSION);
if (err==SUCCESS) {

  // Copy files to Components/myspell
  var myspell_folder = getFolder("Components", "myspell");
  addFile(APP_NAME, "{LANG}-{REGION}.dic", myspell_folder, "");
  addFile(APP_NAME, "{LANG}-{REGION}.aff", myspell_folder, "");
  addFile(APP_NAME, "README-{LANG}-{REGION}.txt", myspell_folder, "");

  err = performInstall();
  if(err == SUCCESS || err == 999) {
    alert(APP_DISPLAY_NAME+" (v "+APP_VERSION+") has been succesfully installed.\n");
  }
  else {
    alert("Installation failed. Error:" + err);
    cancelInstall(err);
  }

}
else {
  cancelInstall(err);
}

